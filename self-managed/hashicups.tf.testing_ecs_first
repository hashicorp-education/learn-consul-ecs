data "kubectl_filename_list" "hashicups_manifests" {
  pattern = "${path.module}/hashicups/*.yaml"
}

resource "kubectl_manifest" "hashicups" {
  count     = length(data.kubectl_filename_list.hashicups_manifests.matches)
  yaml_body = file(element(data.kubectl_filename_list.hashicups_manifests.matches, count.index))

  depends_on = [helm_release.consul]
}
